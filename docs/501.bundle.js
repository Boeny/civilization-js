"use strict";(self.webpackChunkcivilization_js=self.webpackChunkcivilization_js||[]).push([[501],{288:(e,n,t)=>{t.d(n,{A:()=>a});var i=t(1601),o=t.n(i),r=t(6314),s=t.n(r)()(o());s.push([e.id,".bar-container {\n    height: 25px;\n    position: relative;\n    display: flex;\n    align-items: center;\n}\n.bar {\n    height: 5px;\n    width: 100%;\n    background: #7c7c7c;\n}\n.bar-button {\n    outline: 2px solid #656565;\n    border-radius: 50%;\n    position: absolute;\n    top: 4px;\n    background: #ccc;\n    cursor: pointer;\n}\n.bar-button > .tip {\n    position: absolute;\n    top: -18px;\n    background: #fff8d9;\n    border: 1px solid black;\n    font-size: 12px;\n    padding: 0 2px;\n}\n",""]);const a=s},1332:(e,n,t)=>{t.d(n,{a:()=>w});var i=t(4848),o=t(5072),r=t.n(o),s=t(7825),a=t.n(s),c=t(7659),l=t.n(c),u=t(5056),d=t.n(u),h=t(540),p=t.n(h),m=t(1113),v=t.n(m),g=t(288),f={};f.styleTagTransform=v(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=a(),f.insertStyleElement=p(),r()(g.A,f),g.A&&g.A.locals&&g.A.locals;var x=t(6540),b=t(9980);const j=({buttonSize:e=16,defaultValue:n=0,onChange:t,min:o=0,max:r=1,round:s})=>{const a=(0,x.useRef)(null),c=(0,x.useRef)(0),l=(0,x.useRef)(0),u=(0,x.useRef)(0),[d,h]=(0,x.useState)(0);(0,x.useEffect)(()=>{a.current&&(c.current=a.current.clientWidth,u.current=function(e,n,t,i){return(e-t)/(i-t)*n}(n,c.current,o,r),h(n))},[]);const p=e=>{if(u.current===e)return;u.current=e;let n=function(e,n,t,i){return e/n*(i-t)+t}(e,c.current,o,r);s&&(n=Math.round(n)),h(n),t(n)},{startMoving:m}=(0,b.c)(e=>{let n=e.clientX-l.current;n<0&&(n=0),n>c.current&&(n=c.current),p(n)}),v=(e,n)=>{l.current=e.clientX-n,m()};return(0,i.jsxs)("div",{className:"bar-container",onMouseDown:e=>{e.stopPropagation();const n=e.nativeEvent.offsetX;p(n),v(e,n)},children:[(0,i.jsx)("div",{ref:a,className:"bar"}),(0,i.jsx)("div",{className:"bar-button",style:{left:u.current-e/2,width:e,height:e},onMouseDown:e=>{e.stopPropagation(),v(e,u.current)},children:c.current?(0,i.jsx)("div",{className:"tip",children:s?d:d.toFixed(2)}):null})]})},w=({title:e,onChange:n,...t})=>(0,i.jsxs)("div",{style:{padding:"0 8px",position:"relative",marginTop:6},children:[(0,i.jsx)("div",{style:{fontSize:12,position:"absolute",top:-6},children:e}),(0,i.jsx)(j,{...t,onChange:n})]})},2945:(e,n,t)=>{t.d(n,{q:()=>o});var i=t(6540);function o(e,n,t){return(0,i.useCallback)(i=>{n&&e.includes(i)&&t()},[e,n,t])}},3501:(e,n,t)=>{t.r(n),t.d(n,{MiniMap:()=>I});var i=t(4848),o=t(5072),r=t.n(o),s=t(7825),a=t.n(s),c=t(7659),l=t.n(c),u=t(5056),d=t.n(u),h=t(540),p=t.n(h),m=t(1113),v=t.n(m),g=t(4866),f={};f.styleTagTransform=v(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=a(),f.insertStyleElement=p(),r()(g.A,f),g.A&&g.A.locals&&g.A.locals;var x=t(6540),b=t(4035),j=t(5055),w=t(9860),y=t(4067),C=t(3915),k=t(889),M=t(6060),E=t(9209),A=t(205),L=t(6283),z=t(4709),S=t(2945),V=t(7712),R=t(5788),F=t(6630);const O={types:[{description:"Images",accept:{"image/*":[".png",".gif",".jpeg",".jpg"]}}],excludeAcceptAllOption:!0,multiple:!1},P=({map:e,title:n,onClick:t,panelWidth:o})=>{const{width:r,height:s}=(0,R.wm)(o,e);return(0,i.jsx)(w.H,{id:"image-minimap",title:n,width:r,height:s,style:{maxHeight:170,cursor:"pointer"},onClick:t,children:n=>n.drawImage(e,0,0,r,s)})},I=({screenSize:e,title:n,panelWidth:t,isSelected:o,onMapCreate:r,createMapKeyBinding:s})=>{const{store:{map:a},setStore:c}=(0,F.P)(),[l,u]=(0,x.useState)(V.h.center),d=(0,x.useCallback)(async()=>{const n=await async function(){try{const[e]=await window.showOpenFilePicker(O),n=await e.getFile(),t=new Image;return t.src=URL.createObjectURL(n),t.onerror=function(){URL.revokeObjectURL(this.src),console.error("Cannot load image")},new Promise(n=>{t.onload=function(){URL.revokeObjectURL(t.src),t.name=e.name,n(t)}})}catch(e){return console.error(e),null}}();if(!n)return;const t=(0,z.ZE)(E.Nl.image),i=(0,A.Oo)(n.width,n.height);let o={zoom:1,position:(0,A.at)()};l===V.h.fitScreen&&(o=(0,R.lF)(e.x,i.x)),l===V.h.center&&(o=(0,R.qc)(e,i));const{store:{zoom:s,position:a},setStore:u}=M.I;t.length>0?(o.zoom/=s,o.position=(0,A.Ks)(o.position,a),c({map:n,...o}),u({borders:(0,R.qJ)(i,t.map(({map:e})=>e),o.zoom)})):(c({map:n}),u({borders:i,...o})),r()},[l,e]),h=(0,S.q)(s,o,d);return(0,k.D)(h),(0,i.jsx)(L.v,{map:a&&(0,i.jsx)(P,{panelWidth:t,title:o?a.name:n,map:a,onClick:()=>{o&&d()}}),title:n,children:(0,i.jsxs)("div",{children:[(0,i.jsx)(y.s,{name:"imageMapCreationMode",value:l,onChange:u,children:e=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(C.h,{...e,value:V.h.fitScreen,label:"Fit the screen"}),(0,i.jsx)(C.h,{...e,value:V.h.center,label:"Screen center"}),(0,i.jsx)(C.h,{...e,value:V.h.free,label:"Free transform"})]})}),(0,i.jsx)(b.e,{alignCenter:!0,noPadding:!0,children:(0,i.jsxs)(j.$,{onClick:d,children:["Load Image (",s,")"]})})]})})}},3915:(e,n,t)=>{t.d(n,{h:()=>o});var i=t(4848);function o({name:e,label:n,value:t,selectedValue:o,disabled:r,children:s,onChange:a}){const c=(0,i.jsx)("input",{disabled:r,type:"radio",name:e,value:t,checked:t===o,onChange:e=>{const n=e.target.value,i="number"==typeof t?Number(n):n;a(i)}});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:n?(0,i.jsxs)("label",{style:{cursor:"pointer"},children:[c,n]}):c}),s]})}},4067:(e,n,t)=>{t.d(n,{s:()=>o});var i=t(4848);function o({name:e,value:n,children:t,label:o,onChange:r}){return(0,i.jsxs)("div",{children:[o&&(0,i.jsx)("label",{children:o}),t({name:e,selectedValue:n,onChange:r})]})}},4866:(e,n,t)=>{t.d(n,{A:()=>a});var i=t(1601),o=t.n(i),r=t(6314),s=t.n(r)()(o());s.push([e.id,".selected #image-minimap:hover {\n    box-shadow: 0px 0px 12px #000000;\n}\n.selected #image-minimap:active {\n    box-shadow: none;\n}\n",""]);const a=s},5788:(e,n,t)=>{t.d(n,{lF:()=>c,qJ:()=>u,qc:()=>l,wm:()=>h,y$:()=>d});var i=t(6608),o=t(205),r=t(2589);const s=140;function a(e,n){return(0,o.tI)((0,o.Ks)(e,n),2)}function c(e,n){return{zoom:(0,o.pz)(e,n),position:(0,o.at)()}}function l(e,n){const t=(0,o.pz)(r.bD.minWidth,n.x);return{zoom:t,position:a(e,(0,o.oV)(n,t))}}function u(e,n,t){const i=(0,o.oV)(e,t);return function(e,n){const t=(0,o.at)();return[...n,e].forEach(e=>{t.x<e.width&&(t.x=e.width),t.y<e.height&&(t.y=e.height)}),t}({width:i.x,height:i.y},n)}function d(e,n){let t=e/n.rowLength,o=e+t/2;const r=(0,i.df)(t);let a=r*n.columnLength+r/2;const c=o/a;return a>s&&(a=s,o=c*a,t=o/n.rowLength),{width:o,height:a,hexWidth:t}}function h(e,n){let t=e,i=t*n.height/n.width;const o=t/i;return i>s&&(i=s,t=o*i),{width:t,height:i}}},6283:(e,n,t)=>{t.d(n,{v:()=>k});var i=t(4848),o=t(6540),r=t(4035),s=t(5055),a=t(5072),c=t.n(a),l=t(7825),u=t.n(l),d=t(7659),h=t.n(d),p=t(5056),m=t.n(p),v=t(540),g=t.n(v),f=t(1113),x=t.n(f),b=t(8964),j={};j.styleTagTransform=x(),j.setAttributes=m(),j.insert=h().bind(null,"head"),j.domAPI=u(),j.insertStyleElement=g(),c()(b.A,j),b.A&&b.A.locals&&b.A.locals;var w=t(5221);const y=({isVisible:e,toggleVisible:n})=>(0,i.jsx)("div",{className:"eye",onClick:e=>{e.stopPropagation(),n()},children:(0,i.jsx)(w.B,{src:e?'<svg width="20" viewBox="0 0 512 400">\n    <path d="m494.8,241.4l-50.6-49.4c-50.1-48.9-116.9-75.8-188.2-75.8s-138.1,26.9-188.2,75.8l-50.6,49.4c-11.3,12.3-4.3,25.4 0,29.2l50.6,49.4c50.1,48.9 116.9,75.8 188.2,75.8s138.1-26.9 188.2-75.8l50.6-49.4c4-3.8 11.7-16.4 0-29.2zm-238.8,84.4c-38.5,0-69.8-31.3-69.8-69.8 0-38.5 31.3-69.8 69.8-69.8 38.5,0 69.8,31.3 69.8,69.8 0,38.5-31.3,69.8-69.8,69.8zm-195.3-69.8l35.7-34.8c27-26.4 59.8-45.2 95.7-55.4-28.2,20.1-46.6,53-46.6,90.1 0,37.1 18.4,70.1 46.6,90.1-35.9-10.2-68.7-29-95.7-55.3l-35.7-34.7zm355,34.8c-27,26.3-59.8,45.1-95.7,55.3 28.2-20.1 46.6-53 46.6-90.1 0-37.2-18.4-70.1-46.6-90.1 35.9,10.2 68.7,29 95.7,55.4l35.6,34.8-35.6,34.7z"></path>\n</svg>\n':'<svg width="20" viewBox="0 4 24 19">\n    <path stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M21.0006 12.0007C19.2536 15.5766 15.8779 18 12 18M12 18C8.12204 18 4.7463 15.5766 2.99977 12.0002M12 18L12 21M19.4218 14.4218L21.4999 16.5M16.2304 16.9687L17.5 19.5M4.57812 14.4218L2.5 16.5M7.76953 16.9687L6.5 19.5"></path>\n</svg>\n',width:20})});var C=t(1332);function k({title:e,map:n,children:t,...a}){const[c,l]=(0,o.useState)(!0);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"title",children:[e,(0,i.jsxs)(r.e,{noGaps:!0,alignCenter:!0,children:[n&&a.setVisible&&(0,i.jsx)(y,{isVisible:a.isVisible,toggleVisible:()=>a.setVisible(!a.isVisible)}),(n||t)&&(0,i.jsx)(s.$,{style:{padding:0,width:25,height:25,marginLeft:3},onClick:e=>{e.stopPropagation(),l(!c)},children:c?"-":"+"})]})]}),c&&(0,i.jsxs)(i.Fragment,{children:[n&&a.setOpacity&&(0,i.jsx)(C.a,{title:"opacity",defaultValue:1,onChange:a.setOpacity}),n&&(0,i.jsx)("div",{className:"mini-map",children:n}),t]})]})}},8964:(e,n,t)=>{t.d(n,{A:()=>a});var i=t(1601),o=t.n(i),r=t(6314),s=t.n(r)()(o());s.push([e.id,".eye {\n    cursor: pointer;\n    border-radius: 5px;\n    padding: 0 1px;\n    margin-bottom: -1px;\n}\n.eye:hover {\n    outline: 3px solid #7c7c7c;\n}\n",""]);const a=s},9860:(e,n,t)=>{t.d(n,{H:()=>s});var i=t(4848),o=t(6540),r=t(205);const s=({children:e,onClick:n,onMouseDown:t,onMouseMove:s,onMouseUp:a,...c})=>{const l=(0,o.useRef)(null),[u,d]=(0,o.useState)(null);return(0,o.useEffect)(()=>{if(l.current){const n=l.current.getContext("2d");e(n),d(n)}},[e]),(0,i.jsx)("canvas",{ref:l,...c,onClick:n&&u?e=>n(u,(0,r.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0,onMouseDown:t&&u?e=>t(u,(0,r.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0,onMouseMove:s&&u?e=>s(u,(0,r.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0,onMouseUp:a&&u?e=>a(u,(0,r.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0})}},9980:(e,n,t)=>{t.d(n,{c:()=>o});var i=t(6540);function o(e,n=!0){const t=(0,i.useRef)(!1),o=(0,i.useRef)(e);return(0,i.useEffect)(()=>{if(!n)return()=>{};function e(e){t.current&&requestAnimationFrame(()=>o.current(e))}function i(e){e.stopPropagation(),t.current=!1}return document.addEventListener("touchmove",e),document.addEventListener("touchend",i),document.addEventListener("mousemove",e),document.addEventListener("mouseup",i),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",i),document.removeEventListener("touchmove",e),document.removeEventListener("touchend",i)}},[n]),{startMoving:()=>{t.current=!0,o.current=e}}}}}]);