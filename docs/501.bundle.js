"use strict";(self.webpackChunkcivilization_js=self.webpackChunkcivilization_js||[]).push([[501],{288:(e,n,t)=>{t.d(n,{A:()=>a});var i=t(1601),o=t.n(i),s=t(6314),r=t.n(s)()(o());r.push([e.id,".bar-container {\n    height: 25px;\n    position: relative;\n    display: flex;\n    align-items: center;\n}\n.bar {\n    height: 5px;\n    width: 100%;\n    background: #7c7c7c;\n}\n.bar-button {\n    outline: 2px solid #656565;\n    border-radius: 50%;\n    position: absolute;\n    top: 4px;\n    background: #ccc;\n    cursor: pointer;\n}\n",""]);const a=r},2279:(e,n,t)=>{t.d(n,{v:()=>L});var i=t(4848),o=t(6540),s=t(4035),r=t(5055),a=t(5072),c=t.n(a),l=t(7825),d=t.n(l),u=t(7659),h=t.n(u),m=t(5056),v=t.n(m),p=t(540),g=t.n(p),f=t(1113),x=t.n(f),b=t(8964),j={};j.styleTagTransform=x(),j.setAttributes=v(),j.insert=h().bind(null,"head"),j.domAPI=d(),j.insertStyleElement=g(),c()(b.A,j),b.A&&b.A.locals&&b.A.locals;var w=t(5221);const y=({isVisible:e,toggleVisible:n})=>(0,i.jsx)("div",{className:"eye",onClick:e=>{e.stopPropagation(),n()},children:(0,i.jsx)(w.B,{src:e?'<svg width="20" viewBox="0 0 512 400">\n    <path d="m494.8,241.4l-50.6-49.4c-50.1-48.9-116.9-75.8-188.2-75.8s-138.1,26.9-188.2,75.8l-50.6,49.4c-11.3,12.3-4.3,25.4 0,29.2l50.6,49.4c50.1,48.9 116.9,75.8 188.2,75.8s138.1-26.9 188.2-75.8l50.6-49.4c4-3.8 11.7-16.4 0-29.2zm-238.8,84.4c-38.5,0-69.8-31.3-69.8-69.8 0-38.5 31.3-69.8 69.8-69.8 38.5,0 69.8,31.3 69.8,69.8 0,38.5-31.3,69.8-69.8,69.8zm-195.3-69.8l35.7-34.8c27-26.4 59.8-45.2 95.7-55.4-28.2,20.1-46.6,53-46.6,90.1 0,37.1 18.4,70.1 46.6,90.1-35.9-10.2-68.7-29-95.7-55.3l-35.7-34.7zm355,34.8c-27,26.3-59.8,45.1-95.7,55.3 28.2-20.1 46.6-53 46.6-90.1 0-37.2-18.4-70.1-46.6-90.1 35.9,10.2 68.7,29 95.7,55.4l35.6,34.8-35.6,34.7z"></path>\n</svg>\n':'<svg width="20" viewBox="0 4 24 19">\n    <path stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M21.0006 12.0007C19.2536 15.5766 15.8779 18 12 18M12 18C8.12204 18 4.7463 15.5766 2.99977 12.0002M12 18L12 21M19.4218 14.4218L21.4999 16.5M16.2304 16.9687L17.5 19.5M4.57812 14.4218L2.5 16.5M7.76953 16.9687L6.5 19.5"></path>\n</svg>\n',width:20})});var C=t(288),k={};k.styleTagTransform=x(),k.setAttributes=v(),k.insert=h().bind(null,"head"),k.domAPI=d(),k.insertStyleElement=g(),c()(C.A,k),C.A&&C.A.locals&&C.A.locals;var E=t(9980);const M=({buttonSize:e=16,defaultValue:n=0,onChange:t})=>{const s=(0,o.useRef)(null),r=(0,o.useRef)(0),[a,c]=(0,o.useState)(0);(0,o.useEffect)(()=>{s.current&&(r.current=s.current.clientWidth,c(n*r.current))},[s.current]);const l={startingPoint:0},d=e=>{c(e),t(e/r.current)},{startMoving:u}=(0,E.c)(e=>{let n=e.clientX-l.startingPoint;n<0&&(n=0),n>r.current&&(n=r.current),d(n)}),h=(e,n)=>{l.startingPoint=e.clientX-n,u()};return(0,i.jsxs)("div",{className:"bar-container",onMouseDown:e=>{e.stopPropagation();const n=e.nativeEvent.offsetX;d(n),h(e,n)},children:[(0,i.jsx)("div",{ref:s,className:"bar"}),(0,i.jsx)("div",{className:"bar-button",style:{left:a-e/2,width:e,height:e},onMouseDown:e=>{e.stopPropagation(),h(e,a)}})]})},A=({opacity:e,onChange:n})=>(0,i.jsx)("div",{style:{padding:"0 8px"},children:(0,i.jsx)(M,{defaultValue:e,onChange:n})});function L({title:e,map:n,children:t,...a}){const[c,l]=(0,o.useState)(!0);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"title",children:[e,(0,i.jsxs)(s.e,{noGaps:!0,alignCenter:!0,children:[n&&a.setVisible&&(0,i.jsx)(y,{isVisible:a.isVisible,toggleVisible:()=>a.setVisible(!a.isVisible)}),(n||t)&&(0,i.jsx)(r.$,{style:{padding:0,width:25,height:25,marginLeft:3},onClick:e=>{e.stopPropagation(),l(!c)},children:c?"-":"+"})]})]}),c&&(0,i.jsxs)(i.Fragment,{children:[n&&a.setOpacity&&(0,i.jsx)(A,{opacity:a.opacity,onChange:a.setOpacity}),n&&(0,i.jsx)("div",{className:"mini-map",children:n}),t]})]})}},3501:(e,n,t)=>{t.r(n),t.d(n,{MiniMap:()=>F});var i=t(4848),o=t(5072),s=t.n(o),r=t(7825),a=t.n(r),c=t(7659),l=t.n(c),d=t(5056),u=t.n(d),h=t(540),m=t.n(h),v=t(1113),p=t.n(v),g=t(4866),f={};f.styleTagTransform=p(),f.setAttributes=u(),f.insert=l().bind(null,"head"),f.domAPI=a(),f.insertStyleElement=m(),s()(g.A,f),g.A&&g.A.locals&&g.A.locals;var x=t(6540),b=t(4035),j=t(5055),w=t(9860),y=t(4067),C=t(3915),k=t(6060),E=t(2279),M=t(9209),A=t(205),L=t(4709),z=t(7712),P=t(5788),S=t(6630);const V={types:[{description:"Images",accept:{"image/*":[".png",".gif",".jpeg",".jpg"]}}],excludeAcceptAllOption:!0,multiple:!1},O=({map:e,title:n,onClick:t,panelWidth:o})=>{const s=o-29,r=s*e.height/e.width;return(0,i.jsx)(w.H,{id:"image-minimap",title:n,width:s,height:r,style:{maxHeight:170,cursor:"pointer"},onClick:t,children:n=>n.drawImage(e,0,0,s,r)})},F=({screenSize:e,title:n,panelWidth:t,isSelected:o,onMapCreate:s})=>{const{store:{map:r},setStore:a}=(0,S.P)(),[c,l]=(0,x.useState)(z.h.center),d=async()=>{const n=await async function(){try{const[e]=await window.showOpenFilePicker(V),n=await e.getFile(),t=new Image;return t.src=URL.createObjectURL(n),t.onerror=function(){URL.revokeObjectURL(this.src),console.error("Cannot load image")},new Promise(e=>{t.onload=function(){URL.revokeObjectURL(t.src),e(t)}})}catch(e){return console.error(e),null}}();if(!n)return;const t=(0,L.ZE)(M.Nl.image),i=(0,A.Oo)(n.width,n.height);let o={zoom:1,position:(0,A.at)()};c===z.h.fitScreen&&(o=(0,P.lF)(e.x,i.x)),c===z.h.center&&(o=(0,P.qc)(e,i));const{store:{zoom:r,position:l},setStore:d}=k.I;t.length>0?(o.zoom/=r,o.position=(0,A.Ks)(o.position,l),a({map:n,...o}),d({borders:(0,P.qJ)(i,t.map(({map:e})=>e),o.zoom)})):(a({map:n}),d({borders:i,...o})),s()};return(0,i.jsx)(E.v,{map:r&&(0,i.jsx)(O,{panelWidth:t,title:o?"Load new image":n,map:r,onClick:()=>{o&&d()}}),title:n,children:(0,i.jsxs)("div",{children:[(0,i.jsx)(y.s,{name:"imageMapCreationMode",value:c,onChange:l,children:e=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(C.h,{...e,value:z.h.fitScreen,label:"Fit the screen"}),(0,i.jsx)(C.h,{...e,value:z.h.center,label:"Screen center"}),(0,i.jsx)(C.h,{...e,value:z.h.free,label:"Free transform"})]})}),(0,i.jsx)(b.e,{alignCenter:!0,noPadding:!0,children:(0,i.jsx)(j.$,{onClick:d,children:"Load Image"})})]})})}},3915:(e,n,t)=>{t.d(n,{h:()=>o});var i=t(4848);function o({name:e,label:n,value:t,selectedValue:o,disabled:s,children:r,onChange:a}){const c=(0,i.jsx)("input",{disabled:s,type:"radio",name:e,value:t,checked:t===o,onChange:e=>{const n=e.target.value,i="number"==typeof t?Number(n):n;a(i)}});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:n?(0,i.jsxs)("label",{style:{cursor:"pointer"},children:[c,n]}):c}),r]})}},4067:(e,n,t)=>{t.d(n,{s:()=>o});var i=t(4848);function o({name:e,value:n,children:t,label:o,onChange:s}){return(0,i.jsxs)("div",{children:[o&&(0,i.jsx)("label",{children:o}),t({name:e,selectedValue:n,onChange:s})]})}},4866:(e,n,t)=>{t.d(n,{A:()=>a});var i=t(1601),o=t.n(i),s=t(6314),r=t.n(s)()(o());r.push([e.id,".selected #image-minimap:hover {\n    box-shadow: 0px 0px 12px #000000;\n}\n.selected #image-minimap:active {\n    box-shadow: none;\n}\n",""]);const a=r},5788:(e,n,t)=>{t.d(n,{lF:()=>r,qJ:()=>c,qc:()=>a});var i=t(205),o=t(2589);function s(e,n){return(0,i.tI)((0,i.Ks)(e,n),2)}function r(e,n){return{zoom:(0,i.pz)(e,n),position:(0,i.at)()}}function a(e,n){const t=(0,i.pz)(o.bD.minWidth,n.x);return{zoom:t,position:s(e,(0,i.oV)(n,t))}}function c(e,n,t){const o=(0,i.oV)(e,t);return function(e,n){const t=(0,i.at)();return[...n,e].forEach(e=>{t.x<e.width&&(t.x=e.width),t.y<e.height&&(t.y=e.height)}),t}({width:o.x,height:o.y},n)}},8964:(e,n,t)=>{t.d(n,{A:()=>a});var i=t(1601),o=t.n(i),s=t(6314),r=t.n(s)()(o());r.push([e.id,".eye {\n    cursor: pointer;\n    border-radius: 5px;\n    padding: 0 1px;\n    margin-bottom: -1px;\n}\n.eye:hover {\n    outline: 3px solid #7c7c7c;\n}\n",""]);const a=r},9860:(e,n,t)=>{t.d(n,{H:()=>r});var i=t(4848),o=t(6540),s=t(205);const r=({children:e,onClick:n,onMouseDown:t,onMouseMove:r,onMouseUp:a,...c})=>{const l=(0,o.useRef)(null),[d,u]=(0,o.useState)(null);return(0,o.useEffect)(()=>{if(l.current){const n=l.current.getContext("2d");e(n),u(n)}},[e]),(0,i.jsx)("canvas",{ref:l,...c,onClick:n&&d?e=>n(d,(0,s.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0,onMouseDown:t&&d?e=>t(d,(0,s.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0,onMouseMove:r&&d?e=>r(d,(0,s.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0,onMouseUp:a&&d?e=>a(d,(0,s.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0})}},9980:(e,n,t)=>{t.d(n,{c:()=>o});var i=t(6540);function o(e,n=!0){const t=(0,i.useMemo)(()=>({moving:!1,callback:e}),[]);return(0,i.useEffect)(()=>{if(!n)return()=>{};function e(e){t.moving&&requestAnimationFrame(()=>t.callback(e))}function i(e){e.stopPropagation(),t.moving=!1}return document.addEventListener("touchmove",e),document.addEventListener("touchend",i),document.addEventListener("mousemove",e),document.addEventListener("mouseup",i),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",i),document.removeEventListener("touchmove",e),document.removeEventListener("touchend",i)}},[n]),{startMoving:()=>{t.moving=!0,t.callback=e}}}}}]);