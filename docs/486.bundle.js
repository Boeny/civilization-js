"use strict";(self.webpackChunkcivilization_js=self.webpackChunkcivilization_js||[]).push([[486],{288:(e,n,t)=>{t.d(n,{A:()=>a});var o=t(1601),i=t.n(o),s=t(6314),r=t.n(s)()(i());r.push([e.id,".bar-container {\n    height: 25px;\n    position: relative;\n    display: flex;\n    align-items: center;\n}\n.bar {\n    height: 5px;\n    width: 100%;\n    background: #7c7c7c;\n}\n.bar-button {\n    outline: 2px solid #656565;\n    border-radius: 50%;\n    position: absolute;\n    top: 4px;\n    background: #ccc;\n    cursor: pointer;\n}\n",""]);const a=r},2279:(e,n,t)=>{t.d(n,{v:()=>z});var o=t(4848),i=t(6540),s=t(4035),r=t(5055),a=t(5072),l=t.n(a),c=t(7825),d=t.n(c),u=t(7659),h=t.n(u),m=t(5056),p=t.n(m),v=t(540),g=t.n(v),x=t(1113),f=t.n(x),b=t(8964),y={};y.styleTagTransform=f(),y.setAttributes=p(),y.insert=h().bind(null,"head"),y.domAPI=d(),y.insertStyleElement=g(),l()(b.A,y),b.A&&b.A.locals&&b.A.locals;var j=t(5221);const E=({isVisible:e,toggleVisible:n})=>(0,o.jsx)("div",{className:"eye",onClick:e=>{e.stopPropagation(),n()},children:(0,o.jsx)(j.B,{src:e?'<svg width="20" viewBox="0 0 512 400">\n    <path d="m494.8,241.4l-50.6-49.4c-50.1-48.9-116.9-75.8-188.2-75.8s-138.1,26.9-188.2,75.8l-50.6,49.4c-11.3,12.3-4.3,25.4 0,29.2l50.6,49.4c50.1,48.9 116.9,75.8 188.2,75.8s138.1-26.9 188.2-75.8l50.6-49.4c4-3.8 11.7-16.4 0-29.2zm-238.8,84.4c-38.5,0-69.8-31.3-69.8-69.8 0-38.5 31.3-69.8 69.8-69.8 38.5,0 69.8,31.3 69.8,69.8 0,38.5-31.3,69.8-69.8,69.8zm-195.3-69.8l35.7-34.8c27-26.4 59.8-45.2 95.7-55.4-28.2,20.1-46.6,53-46.6,90.1 0,37.1 18.4,70.1 46.6,90.1-35.9-10.2-68.7-29-95.7-55.3l-35.7-34.7zm355,34.8c-27,26.3-59.8,45.1-95.7,55.3 28.2-20.1 46.6-53 46.6-90.1 0-37.2-18.4-70.1-46.6-90.1 35.9,10.2 68.7,29 95.7,55.4l35.6,34.8-35.6,34.7z"></path>\n</svg>\n':'<svg width="20" viewBox="0 4 24 19">\n    <path stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M21.0006 12.0007C19.2536 15.5766 15.8779 18 12 18M12 18C8.12204 18 4.7463 15.5766 2.99977 12.0002M12 18L12 21M19.4218 14.4218L21.4999 16.5M16.2304 16.9687L17.5 19.5M4.57812 14.4218L2.5 16.5M7.76953 16.9687L6.5 19.5"></path>\n</svg>\n',width:20})});var C=t(288),M={};M.styleTagTransform=f(),M.setAttributes=p(),M.insert=h().bind(null,"head"),M.domAPI=d(),M.insertStyleElement=g(),l()(C.A,M),C.A&&C.A.locals&&C.A.locals;var w=t(9980);const S=({buttonSize:e=16,defaultValue:n=0,onChange:t})=>{const s=(0,i.useRef)(null),r=(0,i.useRef)(0),[a,l]=(0,i.useState)(0);(0,i.useEffect)(()=>{s.current&&(r.current=s.current.clientWidth,l(n*r.current))},[s.current]);const c={startingPoint:0},d=e=>{l(e),t(e/r.current)},{startMoving:u}=(0,w.c)(e=>{let n=e.clientX-c.startingPoint;n<0&&(n=0),n>r.current&&(n=r.current),d(n)}),h=(e,n)=>{c.startingPoint=e.clientX-n,u()};return(0,o.jsxs)("div",{className:"bar-container",onMouseDown:e=>{e.stopPropagation();const n=e.nativeEvent.offsetX;d(n),h(e,n)},children:[(0,o.jsx)("div",{ref:s,className:"bar"}),(0,o.jsx)("div",{className:"bar-button",style:{left:a-e/2,width:e,height:e},onMouseDown:e=>{e.stopPropagation(),h(e,a)}})]})},A=({opacity:e,onChange:n})=>(0,o.jsx)("div",{style:{padding:"0 8px"},children:(0,o.jsx)(S,{defaultValue:e,onChange:n})});function z({title:e,map:n,children:t,...a}){const[l,c]=(0,i.useState)(!0);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"title",children:[e,(0,o.jsxs)(s.e,{noGaps:!0,alignCenter:!0,children:[n&&a.setVisible&&(0,o.jsx)(E,{isVisible:a.isVisible,toggleVisible:()=>a.setVisible(!a.isVisible)}),(n||t)&&(0,o.jsx)(r.$,{style:{padding:0,width:25,height:25,marginLeft:3},onClick:e=>{e.stopPropagation(),c(!l)},children:l?"-":"+"})]})]}),l&&(0,o.jsxs)(o.Fragment,{children:[n&&a.setOpacity&&(0,o.jsx)(A,{opacity:a.opacity,onChange:a.setOpacity}),n&&(0,o.jsx)("div",{className:"mini-map",children:n}),t]})]})}},3915:(e,n,t)=>{t.d(n,{h:()=>i});var o=t(4848);function i({name:e,label:n,value:t,selectedValue:i,disabled:s,children:r,onChange:a}){const l=(0,o.jsx)("input",{disabled:s,type:"radio",name:e,value:t,checked:t===i,onChange:e=>{const n=e.target.value,o="number"==typeof t?Number(n):n;a(o)}});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{children:n?(0,o.jsxs)("label",{style:{cursor:"pointer"},children:[l,n]}):l}),r]})}},4067:(e,n,t)=>{t.d(n,{s:()=>i});var o=t(4848);function i({name:e,value:n,children:t,label:i,onChange:s}){return(0,o.jsxs)("div",{children:[i&&(0,o.jsx)("label",{children:i}),t({name:e,selectedValue:n,onChange:s})]})}},5788:(e,n,t)=>{t.d(n,{lF:()=>r,qJ:()=>l,qc:()=>a});var o=t(205),i=t(2589);function s(e,n){return(0,o.tI)((0,o.Ks)(e,n),2)}function r(e,n){return{zoom:(0,o.pz)(e,n),position:(0,o.at)()}}function a(e,n){const t=(0,o.pz)(i.bD.minWidth,n.x);return{zoom:t,position:s(e,(0,o.oV)(n,t))}}function l(e,n,t){const i=(0,o.oV)(e,t);return function(e,n){const t=(0,o.at)();return[...n,e].forEach(e=>{t.x<e.width&&(t.x=e.width),t.y<e.height&&(t.y=e.height)}),t}({width:i.x,height:i.y},n)}},6484:(e,n,t)=>{t.d(n,{A:()=>a});var o=t(1601),i=t.n(o),s=t(6314),r=t.n(s)()(i());r.push([e.id,"label {\n    padding-left: 5px;\n}\nlabel input {\n    margin: 5px;\n}\n",""]);const a=r},7086:(e,n,t)=>{t.d(n,{A:()=>a});var o=t(1601),i=t.n(o),s=t(6314),r=t.n(s)()(i());r.push([e.id,".number-input {\n    width: 50px;\n    outline: none;\n}\n.number-input.error {\n    outline: 2px solid #ff4d4d;\n}\n.number-input.small {\n    width: 35px;\n}\n",""]);const a=r},7339:(e,n,t)=>{t.d(n,{_:()=>r});var o=t(6608),i=t(205);function s(e,n,t){return(0,i.Oo)(e.x+t*Math.cos(n),e.y+t*Math.sin(n))}function r({ctx:e,position:n,offset:t,width:r,color:a,isGridTurnedOn:l}){const c=n.y%2==0?r/2:r,d=(0,o.c)(r),u=(0,o.L$)(d);!function({ctx:e,centerPoint:n,startAngle:t,radius:o,sides:i,fillColor:r,strokeColor:a}){e.beginPath();const l=s(n,t,o);e.moveTo(l.x,l.y);for(let r=0;r<i;r+=1){const a=s(n,r*Math.PI*2/i+t,o);e.lineTo(a.x,a.y)}e.closePath(),r&&(e.fillStyle=r,e.fill()),a&&(e.strokeStyle=a,e.stroke())}({ctx:e,centerPoint:(0,i.Oo)(n.x*r+c+(t?.x||0),n.y*u+d+(t?.y||0)),startAngle:Math.PI/2,radius:d,sides:6,fillColor:a,strokeColor:l?"#000":void 0})}},8964:(e,n,t)=>{t.d(n,{A:()=>a});var o=t(1601),i=t.n(o),s=t(6314),r=t.n(s)()(i());r.push([e.id,".eye {\n    cursor: pointer;\n    border-radius: 5px;\n    padding: 0 1px;\n    margin-bottom: -1px;\n}\n.eye:hover {\n    outline: 3px solid #7c7c7c;\n}\n",""]);const a=r},9486:(e,n,t)=>{t.r(n),t.d(n,{MiniMap:()=>_});var o=t(4848),i=t(9860),s=t(7339),r=t(6608),a=t(6060),l=t(9209),c=t(205),d=t(2279),u=t(3808),h=t(6540),m=t(4035),p=t(5055);function v({label:e,value:n,onChange:t}){return(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"checkbox",checked:n,onChange:e=>t(e.target.checked)}),e]})}var g=t(4067),x=t(3915),f=t(7712),b=t(5072),y=t.n(b),j=t(7825),E=t.n(j),C=t(7659),M=t.n(C),w=t(5056),S=t.n(w),A=t(540),z=t.n(A),k=t(1113),P=t.n(k),V=t(6484),L={};L.styleTagTransform=P(),L.setAttributes=S(),L.insert=M().bind(null,"head"),L.domAPI=E(),L.insertStyleElement=z(),y()(V.A,L),V.A&&V.A.locals&&V.A.locals;var N=t(7086),F={};F.styleTagTransform=P(),F.setAttributes=S(),F.insert=M().bind(null,"head"),F.domAPI=E(),F.insertStyleElement=z(),y()(N.A,F),N.A&&N.A.locals&&N.A.locals;const I=({disabled:e,autoFocus:n,value:t,onEnterKeyDown:i,onChange:s,isError:r,setError:a,style:d,className:u})=>(0,o.jsx)("input",{style:d,disabled:e,autoFocus:n,value:String(t||""),className:(0,c.lw)(["number-input",r&&"error",u]),onKeyUp:e=>e.key===l.OC.enter&&i(),onChange:e=>{const n=function(e){return e.includes(".")?NaN:Number(e)}(e.target.value);(function(e){return(0,c.Li)(e)&&(0,c.rM)(e)&&(0,c._u)(e)})(n)&&(a(!(0,c._q)(n)),s(n))}});function O({mapSize:e,setMapSize:n,onEnterKeyDown:t,isError:i,setError:s}){return(0,o.jsxs)(m.e,{noPadding:!0,alignCenter:!0,style:{fontSize:14,margin:0},children:[(0,o.jsxs)(m.e,{alignedVertically:!0,noPadding:!0,style:{marginRight:5},children:[(0,o.jsx)("div",{children:"width"}),(0,o.jsx)(I,{className:"small",autoFocus:!0,value:e.x,onChange:t=>n({x:t,y:e.y}),onEnterKeyDown:t,isError:i,setError:s})]}),(0,o.jsxs)(m.e,{alignedVertically:!0,noPadding:!0,style:{marginLeft:5},children:[(0,o.jsx)("div",{children:"height"}),(0,o.jsx)(I,{className:"small",value:e.y,onChange:t=>n({x:e.x,y:t}),onEnterKeyDown:t,isError:i,setError:s})]})]})}const T=({hasImageMap:e,onSubmit:n})=>{const[t,i]=(0,h.useState)((0,c.Oo)(100,100)),[s,r]=(0,h.useState)(f.h.fitScreen),[a,l]=(0,h.useState)(!1),[d,u]=(0,h.useState)(!0),b=()=>{n(t,s,d)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(O,{mapSize:t,setMapSize:i,onEnterKeyDown:b,isError:a,setError:l}),(0,o.jsx)(g.s,{name:"hexMapCreationMode",value:s,onChange:r,children:n=>(0,o.jsxs)(o.Fragment,{children:[e&&(0,o.jsx)(x.h,{...n,label:"Fit the image",value:f.h.fitImage}),(0,o.jsx)(x.h,{...n,value:f.h.fitScreen,label:"Fit the screen"}),(0,o.jsx)(x.h,{...n,value:f.h.center,label:"Screen center"}),(0,o.jsx)(x.h,{...n,value:f.h.free,label:"Free transform"})]})}),(0,o.jsx)(m.e,{alignCenter:!0,noPadding:!0,children:(0,o.jsx)(p.$,{disabled:a,onClick:b,children:"Create map"})}),(0,o.jsx)(v,{label:"create water map",value:d,onChange:u})]})};var D=t(4709),W=t(3883),K=t(5788),X=t(2076);const q=({panelWidth:e,title:n,map:t})=>{const a=e/(t.rowLength+10),l=(0,r.df)(a);return(0,o.jsx)(i.H,{title:n,width:e+a/2,height:(l+1)*t.columnLength,style:{maxHeight:170},children:e=>{t.data.forEach((n,t)=>{n.forEach((n,o)=>{(0,s._)({ctx:e,position:{x:o,y:t},width:a,color:u.S[n].color})})})}})},_=({screenSize:e,title:n,panelWidth:t,onMapCreate:i})=>{const{store:{map:s,isVisible:u,opacity:h,hasImageMap:m},setStore:p}=(0,X.P)();return(0,o.jsx)(d.v,{isVisible:u,setVisible:e=>p({isVisible:e}),opacity:h,setOpacity:e=>p({opacity:e}),map:s&&(0,o.jsx)(q,{panelWidth:t,title:n,map:s}),title:n,children:(0,o.jsx)("div",{children:(0,o.jsx)(T,{hasImageMap:m,onSubmit:(n,t,o)=>{const s=(0,D.ZE)(l.Nl.height),d=s.find(({type:e})=>e===l.Nl.image),u=(0,r.df)(W.s.hexWidth),h=(0,c.oV)(n,(0,c.Oo)(W.s.hexWidth,u));let m={zoom:1,position:(0,c.at)()};t===f.h.fitScreen&&(m=(0,K.lF)(e.x,h.x),n.y=Math.floor(e.y/(m.zoom*u))),t===f.h.center&&(m=(0,K.qc)(e,h));const v=a.I.setStore;if(0===s.length){const e=new W.s((0,r.pf)(n,f.N.hill));return p({map:e}),v({borders:e.imageSize,...m}),void i({shouldCreateWaterMap:o})}const{zoom:g,position:x}=a.I.store;t===f.h.fitImage&&d?(m.zoom=d.map.width*d.zoom/(n.x*W.s.hexWidth),n.y=Math.floor(d.map.height*d.zoom/(m.zoom*u)),m.position=d.position):(m.zoom/=g,m.position=(0,c.Ks)(m.position,x));const b=new W.s((0,r.pf)(n,f.N.hill));p({map:b,...m}),v({borders:(0,K.qJ)(b.imageSize,s.map(({map:e})=>e),m.zoom)}),i({shouldCreateWaterMap:o})}})})})}},9860:(e,n,t)=>{t.d(n,{H:()=>r});var o=t(4848),i=t(6540),s=t(205);const r=({children:e,onClick:n,onMouseDown:t,onMouseMove:r,onMouseUp:a,...l})=>{const c=(0,i.useRef)(null),[d,u]=(0,i.useState)(null);return(0,i.useEffect)(()=>{if(c.current){const n=c.current.getContext("2d");e(n),u(n)}},[e]),(0,o.jsx)("canvas",{ref:c,...l,onClick:n&&d?e=>n(d,(0,s.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0,onMouseDown:t&&d?e=>t(d,(0,s.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0,onMouseMove:r&&d?e=>r(d,(0,s.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0,onMouseUp:a&&d?e=>a(d,(0,s.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0})}},9980:(e,n,t)=>{t.d(n,{c:()=>i});var o=t(6540);function i(e,n=!0){const t=(0,o.useMemo)(()=>({moving:!1,callback:e}),[]);return(0,o.useEffect)(()=>{if(!n)return()=>{};function e(e){t.moving&&requestAnimationFrame(()=>t.callback(e))}function o(e){e.stopPropagation(),t.moving=!1}return document.addEventListener("touchmove",e),document.addEventListener("touchend",o),document.addEventListener("mousemove",e),document.addEventListener("mouseup",o),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",o),document.removeEventListener("touchmove",e),document.removeEventListener("touchend",o)}},[n]),{startMoving:()=>{t.moving=!0,t.callback=e}}}}}]);