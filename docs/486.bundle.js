"use strict";(self.webpackChunkcivilization_js=self.webpackChunkcivilization_js||[]).push([[486],{288:(e,n,t)=>{t.d(n,{A:()=>a});var i=t(1601),o=t.n(i),s=t(6314),r=t.n(s)()(o());r.push([e.id,".bar-container {\n    height: 25px;\n    position: relative;\n    display: flex;\n    align-items: center;\n}\n.bar {\n    height: 5px;\n    width: 100%;\n    background: #7c7c7c;\n}\n.bar-button {\n    outline: 2px solid #656565;\n    border-radius: 50%;\n    position: absolute;\n    top: 4px;\n    background: #ccc;\n    cursor: pointer;\n}\n.bar-button > .tip {\n    position: absolute;\n    top: -18px;\n    background: #fff8d9;\n    border: 1px solid black;\n    font-size: 12px;\n    padding: 0 2px;\n}\n",""]);const a=r},1332:(e,n,t)=>{t.d(n,{a:()=>j});var i=t(4848),o=t(5072),s=t.n(o),r=t(7825),a=t.n(r),l=t(7659),c=t.n(l),d=t(5056),u=t.n(d),h=t(540),p=t.n(h),m=t(1113),v=t.n(m),f=t(288),g={};g.styleTagTransform=v(),g.setAttributes=u(),g.insert=c().bind(null,"head"),g.domAPI=a(),g.insertStyleElement=p(),s()(f.A,g),f.A&&f.A.locals&&f.A.locals;var x=t(6540),b=t(9980);const y=({buttonSize:e=16,defaultValue:n=0,onChange:t,min:o=0,max:s=1,round:r})=>{const a=(0,x.useRef)(null),l=(0,x.useRef)(0),c=(0,x.useRef)(0),d=(0,x.useRef)(0),[u,h]=(0,x.useState)(0);(0,x.useEffect)(()=>{a.current&&(l.current=a.current.clientWidth,d.current=function(e,n,t,i){return(e-t)/(i-t)*n}(n,l.current,o,s),h(n))},[]);const p=e=>{if(d.current===e)return;d.current=e;let n=function(e,n,t,i){return e/n*(i-t)+t}(e,l.current,o,s);r&&(n=Math.round(n)),h(n),t(n)},{startMoving:m}=(0,b.c)(e=>{let n=e.clientX-c.current;n<0&&(n=0),n>l.current&&(n=l.current),p(n)}),v=(e,n)=>{c.current=e.clientX-n,m()};return(0,i.jsxs)("div",{className:"bar-container",onMouseDown:e=>{e.stopPropagation();const n=e.nativeEvent.offsetX;p(n),v(e,n)},children:[(0,i.jsx)("div",{ref:a,className:"bar"}),(0,i.jsx)("div",{className:"bar-button",style:{left:d.current-e/2,width:e,height:e},onMouseDown:e=>{e.stopPropagation(),v(e,d.current)},children:l.current?(0,i.jsx)("div",{className:"tip",children:r?u:u.toFixed(2)}):null})]})},j=({title:e,onChange:n,...t})=>(0,i.jsxs)("div",{style:{padding:"0 8px",position:"relative",marginTop:6},children:[(0,i.jsx)("div",{style:{fontSize:12,position:"absolute",top:-6},children:e}),(0,i.jsx)(y,{...t,onChange:n})]})},2945:(e,n,t)=>{t.d(n,{q:()=>o});var i=t(6540);function o(e,n,t){return(0,i.useCallback)(i=>{n&&e.includes(i)&&t()},[e,n,t])}},3915:(e,n,t)=>{t.d(n,{h:()=>o});var i=t(4848);function o({name:e,label:n,value:t,selectedValue:o,disabled:s,children:r,onChange:a}){const l=(0,i.jsx)("input",{disabled:s,type:"radio",name:e,value:t,checked:t===o,onChange:e=>{const n=e.target.value,i="number"==typeof t?Number(n):n;a(i)}});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:n?(0,i.jsxs)("label",{style:{cursor:"pointer"},children:[l,n]}):l}),r]})}},4067:(e,n,t)=>{t.d(n,{s:()=>o});var i=t(4848);function o({name:e,value:n,children:t,label:o,onChange:s}){return(0,i.jsxs)("div",{children:[o&&(0,i.jsx)("label",{children:o}),t({name:e,selectedValue:n,onChange:s})]})}},5788:(e,n,t)=>{t.d(n,{lF:()=>l,qJ:()=>d,qc:()=>c,wm:()=>h,y$:()=>u});var i=t(6608),o=t(205),s=t(2589);const r=140;function a(e,n){return(0,o.tI)((0,o.Ks)(e,n),2)}function l(e,n){return{zoom:(0,o.pz)(e,n),position:(0,o.at)()}}function c(e,n){const t=(0,o.pz)(s.bD.minWidth,n.x);return{zoom:t,position:a(e,(0,o.oV)(n,t))}}function d(e,n,t){const i=(0,o.oV)(e,t);return function(e,n){const t=(0,o.at)();return[...n,e].forEach(e=>{t.x<e.width&&(t.x=e.width),t.y<e.height&&(t.y=e.height)}),t}({width:i.x,height:i.y},n)}function u(e,n){let t=e/n.rowLength,o=e+t/2;const s=(0,i.df)(t);let a=s*n.columnLength+s/2;const l=o/a;return a>r&&(a=r,o=l*a,t=o/n.rowLength),{width:o,height:a,hexWidth:t}}function h(e,n){let t=e,i=t*n.height/n.width;const o=t/i;return i>r&&(i=r,t=o*i),{width:t,height:i}}},6283:(e,n,t)=>{t.d(n,{v:()=>M});var i=t(4848),o=t(6540),s=t(4035),r=t(5055),a=t(5072),l=t.n(a),c=t(7825),d=t.n(c),u=t(7659),h=t.n(u),p=t(5056),m=t.n(p),v=t(540),f=t.n(v),g=t(1113),x=t.n(g),b=t(8964),y={};y.styleTagTransform=x(),y.setAttributes=m(),y.insert=h().bind(null,"head"),y.domAPI=d(),y.insertStyleElement=f(),l()(b.A,y),b.A&&b.A.locals&&b.A.locals;var j=t(5221);const C=({isVisible:e,toggleVisible:n})=>(0,i.jsx)("div",{className:"eye",onClick:e=>{e.stopPropagation(),n()},children:(0,i.jsx)(j.B,{src:e?'<svg width="20" viewBox="0 0 512 400">\n    <path d="m494.8,241.4l-50.6-49.4c-50.1-48.9-116.9-75.8-188.2-75.8s-138.1,26.9-188.2,75.8l-50.6,49.4c-11.3,12.3-4.3,25.4 0,29.2l50.6,49.4c50.1,48.9 116.9,75.8 188.2,75.8s138.1-26.9 188.2-75.8l50.6-49.4c4-3.8 11.7-16.4 0-29.2zm-238.8,84.4c-38.5,0-69.8-31.3-69.8-69.8 0-38.5 31.3-69.8 69.8-69.8 38.5,0 69.8,31.3 69.8,69.8 0,38.5-31.3,69.8-69.8,69.8zm-195.3-69.8l35.7-34.8c27-26.4 59.8-45.2 95.7-55.4-28.2,20.1-46.6,53-46.6,90.1 0,37.1 18.4,70.1 46.6,90.1-35.9-10.2-68.7-29-95.7-55.3l-35.7-34.7zm355,34.8c-27,26.3-59.8,45.1-95.7,55.3 28.2-20.1 46.6-53 46.6-90.1 0-37.2-18.4-70.1-46.6-90.1 35.9,10.2 68.7,29 95.7,55.4l35.6,34.8-35.6,34.7z"></path>\n</svg>\n':'<svg width="20" viewBox="0 4 24 19">\n    <path stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M21.0006 12.0007C19.2536 15.5766 15.8779 18 12 18M12 18C8.12204 18 4.7463 15.5766 2.99977 12.0002M12 18L12 21M19.4218 14.4218L21.4999 16.5M16.2304 16.9687L17.5 19.5M4.57812 14.4218L2.5 16.5M7.76953 16.9687L6.5 19.5"></path>\n</svg>\n',width:20})});var E=t(1332);function M({title:e,map:n,children:t,...a}){const[l,c]=(0,o.useState)(!0);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"title",children:[e,(0,i.jsxs)(s.e,{noGaps:!0,alignCenter:!0,children:[n&&a.setVisible&&(0,i.jsx)(C,{isVisible:a.isVisible,toggleVisible:()=>a.setVisible(!a.isVisible)}),(n||t)&&(0,i.jsx)(r.$,{style:{padding:0,width:25,height:25,marginLeft:3},onClick:e=>{e.stopPropagation(),c(!l)},children:l?"-":"+"})]})]}),l&&(0,i.jsxs)(i.Fragment,{children:[n&&a.setOpacity&&(0,i.jsx)(E.a,{title:"opacity",defaultValue:1,onChange:a.setOpacity}),n&&(0,i.jsx)("div",{className:"mini-map",children:n}),t]})]})}},6484:(e,n,t)=>{t.d(n,{A:()=>a});var i=t(1601),o=t.n(i),s=t(6314),r=t.n(s)()(o());r.push([e.id,"label {\n    padding-left: 5px;\n}\nlabel input {\n    margin: 5px;\n}\n",""]);const a=r},7086:(e,n,t)=>{t.d(n,{A:()=>a});var i=t(1601),o=t.n(i),s=t(6314),r=t.n(s)()(o());r.push([e.id,".number-input {\n    width: 50px;\n    outline: none;\n}\n.number-input.error {\n    outline: 2px solid #ff4d4d;\n}\n.number-input.small {\n    width: 35px;\n}\n",""]);const a=r},7339:(e,n,t)=>{t.d(n,{_:()=>r});var i=t(6608),o=t(205);function s(e,n,t){return(0,o.Oo)(e.x+t*Math.cos(n),e.y+t*Math.sin(n))}function r({ctx:e,position:n,offset:t,width:r,color:a,isGridTurnedOn:l}){const c=n.y%2==0?r/2:r,d=(0,i.c)(r),u=(0,i.L$)(d);!function({ctx:e,centerPoint:n,startAngle:t,radius:i,sides:o,fillColor:r,strokeColor:a}){e.beginPath();const l=s(n,t,i);e.moveTo(l.x,l.y);for(let r=0;r<o;r+=1){const a=s(n,r*Math.PI*2/o+t,i);e.lineTo(a.x,a.y)}e.closePath(),r&&(e.fillStyle=r,e.fill()),a&&(e.strokeStyle=a,e.stroke())}({ctx:e,centerPoint:(0,o.Oo)(n.x*r+c+(t?.x||0),n.y*u+d+(t?.y||0)),startAngle:Math.PI/2,radius:d,sides:6,fillColor:a,strokeColor:l?"#000":void 0})}},8964:(e,n,t)=>{t.d(n,{A:()=>a});var i=t(1601),o=t.n(i),s=t(6314),r=t.n(s)()(o());r.push([e.id,".eye {\n    cursor: pointer;\n    border-radius: 5px;\n    padding: 0 1px;\n    margin-bottom: -1px;\n}\n.eye:hover {\n    outline: 3px solid #7c7c7c;\n}\n",""]);const a=r},9486:(e,n,t)=>{t.r(n),t.d(n,{MiniMap:()=>Y});var i=t(4848),o=t(6540),s=t(9860),r=t(7339),a=t(6608),l=t(6060),c=t(9209),d=t(205),u=t(1332),h=t(3808),p=t(6501),m=t(6283),v=t(4035),f=t(5055);function g({label:e,value:n,onChange:t}){return(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",checked:n,onChange:e=>t(e.target.checked)}),e]})}var x=t(4067),b=t(3915),y=t(889),j=t(2945),C=t(7712),E=t(5072),M=t.n(E),w=t(7825),S=t.n(w),z=t(7659),A=t.n(z),k=t(5056),V=t.n(k),L=t(540),P=t.n(L),N=t(1113),F=t.n(N),I=t(6484),O={};O.styleTagTransform=F(),O.setAttributes=V(),O.insert=A().bind(null,"head"),O.domAPI=S(),O.insertStyleElement=P(),M()(I.A,O),I.A&&I.A.locals&&I.A.locals;var T=t(7086),W={};W.styleTagTransform=F(),W.setAttributes=V(),W.insert=A().bind(null,"head"),W.domAPI=S(),W.insertStyleElement=P(),M()(T.A,W),T.A&&T.A.locals&&T.A.locals;const D=({disabled:e,autoFocus:n,value:t,onEnterKeyDown:o,onChange:s,isError:r,setError:a,style:l,className:u})=>(0,i.jsx)("input",{style:l,disabled:e,autoFocus:n,value:String(t||""),className:(0,d.lw)(["number-input",r&&"error",u]),onKeyUp:e=>e.key===c.OC.enter&&o(),onChange:e=>{const n=function(e){return e.includes(".")?NaN:Number(e)}(e.target.value);(function(e){return(0,d.Li)(e)&&(0,d.rM)(e)&&(0,d._u)(e)})(n)&&(a(!(0,d._q)(n)),s(n))}});function K({mapSize:e,setMapSize:n,onEnterKeyDown:t,isError:o,setError:s}){return(0,i.jsxs)(v.e,{noPadding:!0,alignCenter:!0,style:{fontSize:14,margin:0},children:[(0,i.jsxs)(v.e,{alignedVertically:!0,noPadding:!0,style:{marginRight:5},children:[(0,i.jsx)("div",{children:"width"}),(0,i.jsx)(D,{className:"small",autoFocus:!0,value:e.x,onChange:t=>n({x:t,y:e.y}),onEnterKeyDown:t,isError:o,setError:s})]}),(0,i.jsxs)(v.e,{alignedVertically:!0,noPadding:!0,style:{marginLeft:5},children:[(0,i.jsx)("div",{children:"height"}),(0,i.jsx)(D,{className:"small",value:e.y,onChange:t=>n({x:e.x,y:t}),onEnterKeyDown:t,isError:o,setError:s})]})]})}const R=({isSelected:e,hasImageMap:n,onSubmit:t,createMapKeyBinding:s})=>{const[r,a]=(0,o.useState)((0,d.Oo)(100,100)),[l,c]=(0,o.useState)(C.h.fitScreen),[u,h]=(0,o.useState)(!1),[p,m]=(0,o.useState)(!1),E=(0,o.useCallback)(()=>{t(r,l,p)},[l,r,p,t]),M=(0,j.q)(s,e,E);return(0,y.D)(M),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(K,{mapSize:r,setMapSize:a,onEnterKeyDown:E,isError:u,setError:h}),(0,i.jsx)(x.s,{name:"hexMapCreationMode",value:l,onChange:c,children:e=>(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsx)(b.h,{...e,label:"Fit the image",value:C.h.fitImage}),(0,i.jsx)(b.h,{...e,value:C.h.fitScreen,label:"Fit the screen"}),(0,i.jsx)(b.h,{...e,value:C.h.center,label:"Screen center"}),(0,i.jsx)(b.h,{...e,value:C.h.free,label:"Free transform"})]})}),(0,i.jsx)(v.e,{alignCenter:!0,noPadding:!0,children:(0,i.jsxs)(f.$,{disabled:u,onClick:E,children:["Create map (",s,")"]})}),(0,i.jsx)(g,{label:"create water map",value:p,onChange:m})]})};var q=t(4709),X=t(3883),B=t(5788),_=t(2076);const $=({panelWidth:e,title:n,map:t})=>{const{width:o,height:a,hexWidth:l}=(0,B.y$)(e,t);return(0,i.jsx)(s.H,{title:n,width:o,height:a,children:e=>{e.clearRect(0,0,o,a),t.data.forEach((n,t)=>{n.forEach((n,i)=>{(0,r._)({ctx:e,position:{x:i,y:t},width:l,color:h.S[n].color})})})}})},Y=({isSelected:e,screenSize:n,title:t,panelWidth:s,onMapCreate:r,createMapKeyBinding:h})=>{const{store:{map:v,isVisible:f,hasImageMap:g},setStore:x}=(0,_.P)(),b=(0,o.useCallback)((e,t,i)=>{const o=(0,q.ZE)(c.Nl.height),s=o.find(({type:e})=>e===c.Nl.image),u=(0,a.df)(X.s.hexWidth),h=(0,d.oV)(e,(0,d.Oo)(X.s.hexWidth,u));let p={zoom:1,position:(0,d.at)()};if(t===C.h.fitScreen){p=(0,B.lF)(n.x,h.x);const t=p.zoom*u;e.y=Math.floor(n.y/t),0===e.y&&(e.y=1)}t===C.h.center&&(p=(0,B.qc)(n,h));const m=l.I.setStore;if(0===o.length){const n=new X.s((0,a.pf)(e,C.N.hill));return x({map:n}),m({borders:n.imageSize,...p}),void r({shouldCreateWaterMap:i})}const{zoom:v,position:f}=l.I.store;t===C.h.fitImage&&s?(p.zoom=s.map.width*s.zoom/(e.x*X.s.hexWidth),e.y=Math.floor(s.map.height*s.zoom/(p.zoom*u)),p.position=s.position):(p.zoom/=v,p.position=(0,d.Ks)(p.position,f));const g=new X.s((0,a.pf)(e,C.N.hill));x({map:g,...p}),m({borders:(0,B.qJ)(g.imageSize,o.map(({map:e})=>e),p.zoom)}),r({shouldCreateWaterMap:i})},[n]);return(0,i.jsx)(m.v,{isVisible:f,setVisible:e=>x({isVisible:e}),setOpacity:e=>x({opacity:e}),map:v&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.a,{title:"brush size",round:!0,min:1,max:10,defaultValue:1,onChange:e=>p.i.setStore({size:e})}),(0,i.jsx)($,{panelWidth:s,title:t,map:v})]}),title:t,children:(0,i.jsx)("div",{children:(0,i.jsx)(R,{isSelected:e,hasImageMap:g,onSubmit:b,createMapKeyBinding:h})})})}},9860:(e,n,t)=>{t.d(n,{H:()=>r});var i=t(4848),o=t(6540),s=t(205);const r=({children:e,onClick:n,onMouseDown:t,onMouseMove:r,onMouseUp:a,...l})=>{const c=(0,o.useRef)(null),[d,u]=(0,o.useState)(null);return(0,o.useEffect)(()=>{if(c.current){const n=c.current.getContext("2d");e(n),u(n)}},[e]),(0,i.jsx)("canvas",{ref:c,...l,onClick:n&&d?e=>n(d,(0,s.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0,onMouseDown:t&&d?e=>t(d,(0,s.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0,onMouseMove:r&&d?e=>r(d,(0,s.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0,onMouseUp:a&&d?e=>a(d,(0,s.Oo)(e.nativeEvent.offsetX,e.nativeEvent.offsetY)):void 0})}},9980:(e,n,t)=>{t.d(n,{c:()=>o});var i=t(6540);function o(e,n=!0){const t=(0,i.useRef)(!1),o=(0,i.useRef)(e);return(0,i.useEffect)(()=>{if(!n)return()=>{};function e(e){t.current&&requestAnimationFrame(()=>o.current(e))}function i(e){e.stopPropagation(),t.current=!1}return document.addEventListener("touchmove",e),document.addEventListener("touchend",i),document.addEventListener("mousemove",e),document.addEventListener("mouseup",i),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",i),document.removeEventListener("touchmove",e),document.removeEventListener("touchend",i)}},[n]),{startMoving:()=>{t.current=!0,o.current=e}}}}}]);